# ECS 价格数据结构说明文档

本文档用于说明华为云 ECS（弹性云服务器）价格数据的 JSON 结构，帮助 MCP 工具正确理解和解析价格信息。

## 数据结构概览

ECS 价格数据采用 JSON 格式存储，每条记录代表一个特定配置组合的价格信息。数据结构如下：

```json
{
  "region": "区域名称",
  "zone": "可用区名称",
  "cpu_arch": "CPU架构类型",
  "spec1": "规格类型1（大类）",
  "spec2": "规格类型2（具体型号）",
  "image": "镜像类型",
  "price_table": {
    "headers": ["表头数组"],
    "data": [["数据行数组"]]
  },
  "created_at": "创建时间（ISO 8601格式）"
}
```

## 字段详细说明

### 1. region（区域）
- **类型**: `string`
- **说明**: 华为云区域名称
- **示例**: `"华北-北京四"`
- **用途**: 用于按区域筛选价格信息
- **注意**: 查询时支持区域映射，如"北京一"会自动映射到"北京四"

### 2. zone（可用区）
- **类型**: `string`
- **说明**: 可用区名称，表示该区域下的具体可用区
- **示例**: `"通用可用区"`
- **用途**: 用于按可用区筛选价格信息

### 3. cpu_arch（CPU架构）
- **类型**: `string`
- **说明**: CPU 架构类型
- **示例**: `"X86计算"`
- **常见值**: 
  - `"X86计算"` - X86 架构
  - `"ARM计算"` - ARM 架构
- **用途**: 用于按 CPU 架构筛选价格信息

### 4. spec1（规格类型1）
- **类型**: `string`
- **说明**: 规格的大类分类，描述计算类型
- **示例**: `"通用计算增强型"`
- **常见值**:
  - `"通用计算增强型"`
  - `"内存优化型"`
  - `"计算优化型"`
  - `"GPU加速型"`
  - 等
- **用途**: 用于按规格大类筛选价格信息
- **查询支持**: 可通过 `spec` 字段同时匹配 `spec1` 和 `spec2`

### 5. spec2（规格类型2）
- **类型**: `string`
- **说明**: 具体的规格型号标识
- **示例**: `"Ac9s"`
- **用途**: 用于按具体规格型号筛选价格信息
- **查询支持**: 可通过 `spec` 字段同时匹配 `spec1` 和 `spec2`

### 6. image（镜像类型）
- **类型**: `string`
- **说明**: 操作系统镜像类型
- **示例**: `"Windows"`
- **常见值**:
  - `"Windows"` - Windows 操作系统
  - `"Linux"` - Linux 操作系统
  - `"CentOS"` - CentOS 系统
  - `"Ubuntu"` - Ubuntu 系统
  - 等
- **用途**: 用于按镜像类型筛选价格信息

### 7. price_table（价格表）
- **类型**: `object`
- **说明**: 包含价格表格的完整结构，包括表头和数据行

#### 7.1 headers（表头）
- **类型**: `array<string>`
- **说明**: 价格表格的列标题数组
- **示例**: `["规格名称", "核数", "内存", "按小时", "包月", "包1年", "包2年", "包3年", ""]`
- **列说明**:
  - `"规格名称"` - ECS 实例规格名称（如 `ac9s.large.2`）
  - `"核数"` - CPU 核心数（如 `"2核"`）
  - `"内存"` - 内存大小（如 `"4GiB"`）
  - `"按小时"` - 按小时计费价格（如 `"0.287 元"`）
  - `"包月"` - 包月价格（如 `"137.98 元"`）
  - `"包1年"` - 包1年价格（如 `"1,379.8 元"`）
  - `"包2年"` - 包2年价格（如 `"2,318.06 元"`）
  - `"包3年"` - 包3年价格（如 `"2,732 元"`）
  - 最后一个空字符串可能用于扩展列

#### 7.2 data（数据行）
- **类型**: `array<array<string>>`
- **说明**: 价格表格的数据行数组，每行对应一个规格的价格信息
- **格式**: 每行数据与 `headers` 数组一一对应
- **示例行**: `["ac9s.large.2", "2核", "4GiB", "0.287 元", "137.98 元", "1,379.8 元", "2,318.06 元", "2,732 元"]`
- **数据说明**:
  - 第一列：规格名称（如 `ac9s.large.2`）
  - 第二列：CPU 核数（如 `"2核"`）
  - 第三列：内存大小（如 `"4GiB"`）
  - 第四列及之后：各种计费方式的价格（包含货币单位，如 `"0.287 元"`）

### 8. created_at（创建时间）
- **类型**: `string`
- **说明**: 数据创建时间，采用 ISO 8601 格式
- **示例**: `"2025-11-21T12:53:24.580167"`
- **格式**: `YYYY-MM-DDTHH:MM:SS.ffffff`
- **用途**: 用于追踪数据的更新时间

## 数据示例

完整的数据记录示例：

```json
{
  "region": "华北-北京四",
  "zone": "通用可用区",
  "cpu_arch": "X86计算",
  "spec1": "通用计算增强型",
  "spec2": "Ac9s",
  "image": "Windows",
  "price_table": {
    "headers": ["规格名称", "核数", "内存", "按小时", "包月", "包1年", "包2年", "包3年", ""],
    "data": [
      ["ac9s.large.2", "2核", "4GiB", "0.287 元", "137.98 元", "1,379.8 元", "2,318.06 元", "2,732 元"],
      ["ac9s.large.4", "2核", "8GiB", "0.432 元", "207.57 元", "2,075.7 元", "3,487.18 元", "4,109.89 元"],
      ["ac9s.xlarge.2", "4核", "8GiB", "0.575 元", "275.95 元", "2,759.5 元", "4,635.96 元", "5,463.81 元"]
    ]
  },
  "created_at": "2025-11-21T12:53:24.580167"
}
```

## 查询字段说明

MCP 工具在查询价格时，可以使用以下字段进行筛选（支持模糊匹配）：

| 字段名 | 说明 | 示例值 |
|--------|------|--------|
| `region` | 区域名称 | `"华北-北京四"` |
| `zone` | 可用区名称 | `"通用可用区"` |
| `cpu_arch` | CPU架构 | `"X86计算"` |
| `spec1` | 规格大类 | `"通用计算增强型"` |
| `spec2` | 规格型号 | `"Ac9s"` |
| `spec` | 规格（同时匹配 spec1 和 spec2） | `"Ac9s"` 或 `"通用计算增强型"` |
| `image` | 镜像类型 | `"Windows"` |

### 注意事项

1. **数组索引**: 数据行数组使用 0-based 索引，第一列（规格名称）的索引是 `[0]`
2. **数据类型**: 所有数据都是字符串类型，需要手动解析数值和单位
3. **空值处理**: 最后一列（索引 `[8]`）可能为空字符串，访问时需注意
4. **价格格式**: 价格字符串包含货币单位和千位分隔符，解析时需要清理
5. **数组长度**: 不同记录的数据行数量可能不同，遍历前应检查数组长度
6. **规格名称格式**: 规格名称遵循特定格式（如 `ac9s.large.2`），可用于模式匹配

## 使用场景

1. **价格查询**: 根据区域、规格、镜像等条件查询 ECS 实例价格
2. **价格对比**: 对比不同规格、不同计费方式的价格
3. **成本估算**: 根据业务需求估算云服务器成本
4. **规格推荐**: 根据预算和需求推荐合适的 ECS 规格

## 注意事项

1. **价格单位**: 所有价格字段都包含货币单位（"元"），解析时需要注意
2. **数据格式**: 价格数值可能包含千位分隔符（逗号），如 `"1,379.8 元"`
3. **区域映射**: 查询"北京一"时会自动映射到"北京四"
4. **模糊匹配**: 所有查询字段都支持模糊匹配（使用 `search` 方法）
5. **数据更新**: `created_at` 字段可用于判断数据的时效性
6. **空值处理**: `price_table.headers` 的最后一个元素可能为空字符串，解析时需注意

## 数据存储

- **存储格式**: JSON 格式存储在 TinyDB 数据库中
- **数据库文件**: `ecs_price.json`
- **查询工具**: 使用 `query_price` 函数进行查询
- **返回格式**: 查询结果返回 JSON 格式字符串，包含查询条件和匹配的记录列表
